nohup: 忽略输入
X_train type:  <class 'numpy.ndarray'>
X_train shape:  (4560, 5625)
X_test type:  <class 'numpy.ndarray'>
X_test shape:  (4560, 5625)
processing dataset...
X_train1 and 2 shape:  (4560, 1687) (4560, 3938)
(4560, 1687) (4560, 3938) 1687 3938 (4560,) (4560, 1687) (4560,)
ratio:  0.7
(1, 1687) (1, 3938)
secret sharing model A...
secret sharing model B...
wa1 shape:  (1, 1687)
batch 0forward..batch cost: 414.0175344944sbatch 1forward..batch cost: 835.9483623504639sbatch 2forward..batch cost: 1255.993674993515sbatch 3forward..batch cost: 1681.5598781108856sbatch 4forward..batch cost: 2107.3849160671234sbatch 5forward..batch cost: 2535.726572751999sbatch 6forward..batch cost: 2961.215287208557sbatch 7forward..batch cost: 3385.0830969810486sbatch 8forward..batch cost: 3808.7148151397705sbatch 9forward..batch cost: 4231.087553262711sbatch 10forward..batch cost: 4656.991812944412sbatch 11forward..batch cost: 5081.577228307724sbatch 12forward..batch cost: 5506.925093412399sbatch 13forward..batch cost: 5932.654077529907sbatch 14forward..batch cost: 6359.949725627899sbatch 15forward..batch cost: 6782.644675016403sbatch 16forward..batch cost: 7196.499559879303sbatch 17forward..batch cost: 7532.089161872864sEpoch 1, batch sum loss: 0.6916800031177731 Time: 7532.090751886368s
batch 0forward..batch cost: 409.45642256736755sbatch 1forward..batch cost: 822.2369089126587sbatch 2forward..batch cost: 1235.0493779182434sbatch 3forward..batch cost: 1647.4969153404236sbatch 4forward..batch cost: 2058.23593378067sbatch 5forward..batch cost: 2471.2902886867523sbatch 6forward..batch cost: 2882.7705636024475sbatch 7forward..batch cost: 3295.873274087906sbatch 8forward..batch cost: 3708.640378475189sbatch 9forward..batch cost: 4120.67679643631sbatch 10forward..batch cost: 4533.07203912735sbatch 11forward..batch cost: 4944.69416809082sbatch 12forward..batch cost: 5357.780569314957sbatch 13forward..batch cost: 5771.248539686203sbatch 14forward..batch cost: 6183.278558969498sbatch 15forward..batch cost: 6597.781179904938sbatch 16forward..batch cost: 7012.91347193718sbatch 17forward..batch cost: 7349.873250007629sEpoch 2, batch sum loss: 0.6915372332636665 Time: 7349.874853610992s
batch 0forward..batch cost: 413.3507664203644sbatch 1forward..batch cost: 829.9244179725647sbatch 2forward..batch cost: 1242.2998039722443sbatch 3forward..batch cost: 1655.2906153202057sbatch 4forward..batch cost: 2070.510340690613sbatch 5forward..batch cost: 2487.1821053028107sbatch 6forward..batch cost: 2903.4568371772766sbatch 7forward..batch cost: 3319.3091835975647sbatch 8forward..batch cost: 3732.584052324295sbatch 9forward..batch cost: 4145.71522974968sbatch 10forward..batch cost: 4560.511151313782sbatch 11forward..batch cost: 4973.970874071121sbatch 12forward..batch cost: 5389.87696146965sbatch 13forward..batch cost: 5803.252860546112sbatch 14forward..batch cost: 6219.529723167419sbatch 15forward..batch cost: 6635.381819725037sbatch 16forward..batch cost: 7049.372233867645sbatch 17forward..batch cost: 7386.83599114418sEpoch 3, batch sum loss: 0.6915243895851191 Time: 7386.837528705597s
batch 0forward..batch cost: 412.65935254096985sbatch 1forward..batch cost: 830.7046947479248sbatch 2forward..batch cost: 1243.4469451904297sbatch 3forward..batch cost: 1656.0906467437744sbatch 4forward..batch cost: 2068.3208816051483sbatch 5forward..batch cost: 2483.736585855484sbatch 6forward..batch cost: 2897.901626110077sbatch 7forward..batch cost: 3313.612688779831sbatch 8forward..batch cost: 3727.7472145557404sbatch 9forward..batch cost: 4141.543193101883sbatch 10forward..batch cost: 4554.345911502838sbatch 11forward..batch cost: 4970.722532510757sbatch 12forward..batch cost: 5385.380715370178sbatch 13forward..batch cost: 5800.731286048889sbatch 14forward..batch cost: 6216.7602434158325sbatch 15forward..batch cost: 6631.538503646851sbatch 16forward..batch cost: 7047.781054019928sbatch 17forward..batch cost: 7386.284157037735sEpoch 4, batch sum loss: 0.6915183781659396 Time: 7386.285526514053s
batch 0forward..batch cost: 730.5558552742004sbatch 1forward..batch cost: 1569.1056551933289sbatch 2forward..batch cost: 2400.8319697380066sbatch 3forward..batch cost: 3252.713832616806sbatch 4forward..batch cost: 4093.621113061905sbatch 5forward..batch cost: 4934.775040626526sbatch 6forward..batch cost: 5790.045228242874sbatch 7forward..batch cost: 6634.157148361206sbatch 8forward..batch cost: 7348.753634691238sbatch 9forward..batch cost: 7975.973036766052sbatch 10forward..batch cost: 8792.99759221077sbatch 11forward..batch cost: 9634.543308973312sbatch 12forward..batch cost: 10483.70335817337sbatch 13forward..batch cost: 11330.786145210266sbatch 14forward..batch cost: 12189.610079288483sbatch 15forward..batch cost: 13028.207770824432sbatch 16forward..batch cost: 13866.930118322372sbatch 17forward..batch cost: 14559.58228802681sEpoch 5, batch sum loss: 0.6915122040629674 Time: 14559.585101366043s
batch 0forward..batch cost: 553.4340388774872sbatch 1forward..batch cost: 1308.0968751907349sbatch 2forward..batch cost: 2151.544927597046sbatch 3forward..batch cost: 2992.2946739196777sbatch 4forward..batch cost: 3837.659696340561sbatch 5forward..batch cost: 4684.041242361069sbatch 6forward..batch cost: 5520.928723573685sbatch 7forward..batch cost: 6385.713516712189sbatch 8forward..batch cost: 7225.372689962387sbatch 9forward..batch cost: 7898.12118601799sbatch 10forward..batch cost: 8430.056322336197sbatch 11forward..batch cost: 9253.939290523529sbatch 12forward..batch cost: 10103.486435174942sbatch 13forward..batch cost: 10931.445415496826sbatch 14forward..batch cost: 11771.624127626419sbatch 15forward..batch cost: 12610.037738323212sbatch 16forward..batch cost: 13443.938384056091sbatch 17forward..batch cost: 14128.34969496727sEpoch 6, batch sum loss: 0.6915083849750107 Time: 14128.351932525635s
batch 0forward..batch cost: 847.2096066474915sbatch 1forward..batch cost: 1400.0562245845795sbatch 2forward..batch cost: 1828.1114678382874sbatch 3forward..batch cost: 2531.324071407318sbatch 4forward..batch cost: 3354.200917005539sbatch 5forward..batch cost: 4190.54803609848sbatch 6forward..batch cost: 5034.677209377289sbatch 7forward..batch cost: 5881.833200454712sbatch 8forward..batch cost: 6715.312804937363sbatch 9forward..batch cost: 7544.335512876511sbatch 10forward..batch cost: 8384.264926195145sbatch 11forward..batch cost: 8935.383835792542sbatch 12forward..batch cost: 9351.788891792297sbatch 13forward..batch cost: 10037.005442380905sbatch 14forward..batch cost: 10855.412202835083sbatch 15forward..batch cost: 11680.151980638504sbatch 16forward..batch cost: 12503.25070309639sbatch 17forward..batch cost: 12969.4946911335sEpoch 7, batch sum loss: 0.6915063287943402 Time: 12969.497247219086s
batch 0forward..batch cost: 689.5389711856842sbatch 1forward..batch cost: 1522.7384543418884sbatch 2forward..batch cost: 2356.1548149585724sbatch 3forward..batch cost: 3185.180811405182sbatch 4forward..batch cost: 3614.939131975174sbatch 5forward..batch cost: 4410.81121301651sbatch 6forward..batch cost: 5235.76350402832sbatch 7forward..batch cost: 6053.696435451508sbatch 8forward..batch cost: 6876.649381399155sbatch 9forward..batch cost: 7426.83246254921sbatch 10forward..batch cost: 8251.029702186584sbatch 11forward..batch cost: 9081.474645853043sbatch 12forward..batch cost: 9917.592448234558sbatch 13forward..batch cost: 10396.825546264648sbatch 14forward..batch cost: 11115.958584070206sbatch 15forward..batch cost: 11945.213939905167sbatch 16forward..batch cost: 12772.757934093475sbatch 17forward..batch cost: 13428.494325399399sEpoch 8, batch sum loss: 0.6915038843364592 Time: 13428.497337341309s
batch 0forward..batch cost: 443.7608826160431sbatch 1forward..batch cost: 1069.4743900299072sbatch 2forward..batch cost: 1615.8349838256836sbatch 3forward..batch cost: 2371.4313774108887sbatch 4forward..batch cost: 2888.3374977111816sbatch 5forward..batch cost: 3537.8585369586945sbatch 6forward..batch cost: 4144.233667612076sbatch 7forward..batch cost: 4659.410566806793sbatch 8forward..batch cost: 5416.379141330719sbatch 9forward..batch cost: 5911.605683088303sbatch 10forward..batch cost: 6568.457650899887sbatch 11forward..batch cost: 7177.979301929474sbatch 12forward..batch cost: 7765.595892190933sbatch 13forward..batch cost: 8180.649605751038sbatch 14forward..batch cost: 8601.998429059982sbatch 15forward..batch cost: 9020.222513914108sbatch 16forward..batch cost: 9435.373754501343sbatch 17forward..batch cost: 9780.783759355545sEpoch 9, batch sum loss: 0.691502101920068 Time: 9780.785371541977s
batch 0forward..batch cost: 418.58939361572266sbatch 1forward..batch cost: 840.1423211097717sbatch 2forward..batch cost: 1252.8885209560394sbatch 3forward..batch cost: 1672.3857061862946sbatch 4forward..batch cost: 2090.1796822547913sbatch 5forward..batch cost: 2514.172106742859sbatch 6forward..batch cost: 2933.811698913574sbatch 7forward..batch cost: 3352.272279024124sbatch 8forward..batch cost: 3767.463252544403sbatch 9forward..batch cost: 4178.705439329147sbatch 10forward..batch cost: 4596.549979925156sbatch 11forward..batch cost: 5010.949123620987sbatch 12forward..batch cost: 5424.845983743668sbatch 13forward..batch cost: 5840.818526029587sbatch 14forward..batch cost: 6254.896790266037sbatch 15forward..batch cost: 6674.222200393677sbatch 16forward..batch cost: 7093.791534900665sbatch 17forward..batch cost: 7429.410724878311sEpoch 10, batch sum loss: 0.6915003786448217 Time: 7429.412464380264s
batch 0forward..batch cost: 415.01407527923584sbatch 1forward..batch cost: 826.1784257888794sbatch 2forward..batch cost: 1239.8932917118073sbatch 3forward..batch cost: 1654.4411199092865sbatch 4forward..batch cost: 2066.838912010193sbatch 5forward..batch cost: 2481.5750489234924sbatch 6forward..batch cost: 2900.8018341064453sbatch 7forward..batch cost: 3317.109525203705sbatch 8forward..batch cost: 3733.1911845207214sbatch 9forward..batch cost: 4146.349848985672sbatch 10forward..batch cost: 4562.694308996201sbatch 11forward..batch cost: 4974.075628042221sbatch 12forward..batch cost: 5389.76181268692sbatch 13forward..batch cost: 5805.736363172531sbatch 14forward..batch cost: 6221.938757896423sbatch 15forward..batch cost: 6640.177008628845sbatch 16forward..batch cost: 7059.074349403381sbatch 17forward..batch cost: 7398.4630036354065sEpoch 11, batch sum loss: 0.6914982330919701 Time: 7398.464501857758s
batch 0forward..batch cost: 416.68390941619873sbatch 1forward..batch cost: 834.20703291893sbatch 2forward..batch cost: 1254.3665997982025sbatch 3forward..batch cost: 1676.7852427959442sbatch 4forward..batch cost: 2093.764529466629sbatch 5forward..batch cost: 2510.801614522934sbatch 6forward..batch cost: 2929.273688316345sbatch 7forward..batch cost: 3346.0608327388763sbatch 8forward..batch cost: 3764.559627056122sbatch 9forward..batch cost: 4182.717191696167sbatch 10forward..batch cost: 4600.340765476227sbatch 11forward..batch cost: 5017.046762228012sbatch 12forward..batch cost: 5435.025280952454sbatch 13forward..batch cost: 5851.834121704102sbatch 14forward..batch cost: 6272.221615314484sbatch 15forward..batch cost: 6690.9650638103485sbatch 16forward..batch cost: 7112.505900144577sbatch 17forward..batch cost: 7451.277920722961sEpoch 12, batch sum loss: 0.6914976075987795 Time: 7451.279689073563s
convergence--wa1 shape:  (1, 1687)
convergence--wb1 shape:  (1, 3938)
wa1,wa2:  [[61804.681460775806 22443.378864411545 8822.382024311923 ...
  61937.95245063277 56700.734659906 54183.66037708092]] [[-61804.681435573446 -22443.37865463794 -8822.381883513039 ...
  -61937.95252829943 -56700.73455314086 -54183.660346006305]]
self.model_weights2:  [[2.5202360120601952e-05 0.00020977360327378847 0.00014079888387641404
  ... 8.634365076432005e-05 5.506711022462696e-05 3.0248666007537395e-05]]
A return/
A return while
Done.
Done.
Total time cost:  116805.93132185936 s
score:  4319
len(y):  4560
Predict precision:  0.9471491228070176
